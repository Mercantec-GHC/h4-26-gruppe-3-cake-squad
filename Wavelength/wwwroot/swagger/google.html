<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <h1> google</h1>

    <script>
        
        const query = window.location.search;
        const urlParams = new URLSearchParams(query);

        const paramCode = urlParams.get("code");
        if(paramCode) {
            fetch("/auth/oauth/google/callback", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ code: paramCode })
            })
                .then(r => r.json())
                .then(data => {
                    console.log("User info:", data);
                    if (window.opener) {
                        window.opener.postMessage({
                            type: "login-complete", payload: data
                        }, "*");
                    }
                    window.close();
                });
        }

    </script>
</body>
</html>